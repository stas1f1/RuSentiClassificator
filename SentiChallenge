{"nbformat":4,"nbformat_minor":0,"metadata":{"colab":{"provenance":[],"collapsed_sections":[],"mount_file_id":"1Ce91AWNJl2XAnaYvwYBv7tzidhRttbM3","authorship_tag":"ABX9TyMpLoycBSKbVWq/V/VULl2V"},"kernelspec":{"name":"python3","display_name":"Python 3"},"language_info":{"name":"python"},"accelerator":"GPU","gpuClass":"standard","widgets":{"application/vnd.jupyter.widget-state+json":{"0b71a1fb1f664154977f16449a436dd2":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_3d75442a07dc41788c04d58c6afdae56","IPY_MODEL_fbfde7ab75264efcaa31c30b91a5e488","IPY_MODEL_4fc3835b2ebe4c74ab973c1573a2e6ac"],"layout":"IPY_MODEL_8a2bffc8d9d14982848eefcaf8b6240a"}},"3d75442a07dc41788c04d58c6afdae56":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_b2a64613d3c149aab640d29d725d6739","placeholder":"​","style":"IPY_MODEL_68ea6332e6c746d38b97c43a9a872850","value":"Downloading special_tokens_map.json: 100%"}},"fbfde7ab75264efcaa31c30b91a5e488":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_06c4bc2864824e5a967c51bdf5f20996","max":112,"min":0,"orientation":"horizontal","style":"IPY_MODEL_af594ebc093241ed8c526a042b4049a7","value":112}},"4fc3835b2ebe4c74ab973c1573a2e6ac":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_d980648957cd4b15a3a2539fc427f7c1","placeholder":"​","style":"IPY_MODEL_cc27a38ba3384283b5f72422b259d312","value":" 112/112 [00:00&lt;00:00, 2.26kB/s]"}},"8a2bffc8d9d14982848eefcaf8b6240a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b2a64613d3c149aab640d29d725d6739":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"68ea6332e6c746d38b97c43a9a872850":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"06c4bc2864824e5a967c51bdf5f20996":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"af594ebc093241ed8c526a042b4049a7":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"d980648957cd4b15a3a2539fc427f7c1":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"cc27a38ba3384283b5f72422b259d312":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"2eeb5517d66f447199bf15b082f14fb3":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_df21ad688d974ecd8db829d67ded30bd","IPY_MODEL_28ac007521a64687b46276732a70b411","IPY_MODEL_d66338ca495245a5be7eb326e42ca398"],"layout":"IPY_MODEL_7cf3f54869654c0a97bb4ef41eb3d4c2"}},"df21ad688d974ecd8db829d67ded30bd":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_14f9e6c434bd4917be1632074a0e41f5","placeholder":"​","style":"IPY_MODEL_61d4d25fc1c24b38873712b2ff24eb02","value":"Downloading tokenizer_config.json: 100%"}},"28ac007521a64687b46276732a70b411":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_05ca74bb72704f9e8d65da7bebe27699","max":24,"min":0,"orientation":"horizontal","style":"IPY_MODEL_952365bc376d4a7080027d67b93cbb93","value":24}},"d66338ca495245a5be7eb326e42ca398":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_37c696a0d47747a287e26f23bb2dac8b","placeholder":"​","style":"IPY_MODEL_48202f51088f40fda6a50f242830b6d4","value":" 24.0/24.0 [00:00&lt;00:00, 661B/s]"}},"7cf3f54869654c0a97bb4ef41eb3d4c2":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"14f9e6c434bd4917be1632074a0e41f5":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"61d4d25fc1c24b38873712b2ff24eb02":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"05ca74bb72704f9e8d65da7bebe27699":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"952365bc376d4a7080027d67b93cbb93":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"37c696a0d47747a287e26f23bb2dac8b":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"48202f51088f40fda6a50f242830b6d4":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"7ffc811ad1b04f809832044ba4a53071":{"model_module":"@jupyter-widgets/controls","model_name":"HBoxModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HBoxModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HBoxView","box_style":"","children":["IPY_MODEL_dbb97451793a4d2eba3043e381a4affa","IPY_MODEL_4d362863dc03450396928886cc5db41b","IPY_MODEL_d9d6a6533b1f4efc9a50ded41c814e92"],"layout":"IPY_MODEL_9053fe4cb8834c278f5ce4725a213f80"}},"dbb97451793a4d2eba3043e381a4affa":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_67daacc99876483789ccd5810dca7a8f","placeholder":"​","style":"IPY_MODEL_14533a2f106147beb34fd5cff8fad306","value":"Downloading config.json: 100%"}},"4d362863dc03450396928886cc5db41b":{"model_module":"@jupyter-widgets/controls","model_name":"FloatProgressModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"FloatProgressModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"ProgressView","bar_style":"success","description":"","description_tooltip":null,"layout":"IPY_MODEL_10007eacfb7c4e03be277c5a8a1eb22a","max":642,"min":0,"orientation":"horizontal","style":"IPY_MODEL_b3ff25f80d7946f384d7f908704fa563","value":642}},"d9d6a6533b1f4efc9a50ded41c814e92":{"model_module":"@jupyter-widgets/controls","model_name":"HTMLModel","model_module_version":"1.5.0","state":{"_dom_classes":[],"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"HTMLModel","_view_count":null,"_view_module":"@jupyter-widgets/controls","_view_module_version":"1.5.0","_view_name":"HTMLView","description":"","description_tooltip":null,"layout":"IPY_MODEL_91d1e6dfbef44e6392ac6b6939a105f8","placeholder":"​","style":"IPY_MODEL_fa35dac13937444ba8582ba793250a1e","value":" 642/642 [00:00&lt;00:00, 4.37kB/s]"}},"9053fe4cb8834c278f5ce4725a213f80":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"67daacc99876483789ccd5810dca7a8f":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"14533a2f106147beb34fd5cff8fad306":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}},"10007eacfb7c4e03be277c5a8a1eb22a":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"b3ff25f80d7946f384d7f908704fa563":{"model_module":"@jupyter-widgets/controls","model_name":"ProgressStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"ProgressStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","bar_color":null,"description_width":""}},"91d1e6dfbef44e6392ac6b6939a105f8":{"model_module":"@jupyter-widgets/base","model_name":"LayoutModel","model_module_version":"1.2.0","state":{"_model_module":"@jupyter-widgets/base","_model_module_version":"1.2.0","_model_name":"LayoutModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"LayoutView","align_content":null,"align_items":null,"align_self":null,"border":null,"bottom":null,"display":null,"flex":null,"flex_flow":null,"grid_area":null,"grid_auto_columns":null,"grid_auto_flow":null,"grid_auto_rows":null,"grid_column":null,"grid_gap":null,"grid_row":null,"grid_template_areas":null,"grid_template_columns":null,"grid_template_rows":null,"height":null,"justify_content":null,"justify_items":null,"left":null,"margin":null,"max_height":null,"max_width":null,"min_height":null,"min_width":null,"object_fit":null,"object_position":null,"order":null,"overflow":null,"overflow_x":null,"overflow_y":null,"padding":null,"right":null,"top":null,"visibility":null,"width":null}},"fa35dac13937444ba8582ba793250a1e":{"model_module":"@jupyter-widgets/controls","model_name":"DescriptionStyleModel","model_module_version":"1.5.0","state":{"_model_module":"@jupyter-widgets/controls","_model_module_version":"1.5.0","_model_name":"DescriptionStyleModel","_view_count":null,"_view_module":"@jupyter-widgets/base","_view_module_version":"1.2.0","_view_name":"StyleView","description_width":""}}}}},"cells":[{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YZz3rysW4vfO","executionInfo":{"status":"ok","timestamp":1662199198390,"user_tz":-180,"elapsed":14874,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"46517560-12fb-4d7b-b580-1b386eceb1df"},"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting transformers\n","  Downloading transformers-4.21.2-py3-none-any.whl (4.7 MB)\n","\u001b[K     |████████████████████████████████| 4.7 MB 4.3 MB/s \n","\u001b[?25hRequirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.7/dist-packages (from transformers) (6.0)\n","Collecting tokenizers!=0.11.3,<0.13,>=0.11.1\n","  Downloading tokenizers-0.12.1-cp37-cp37m-manylinux_2_12_x86_64.manylinux2010_x86_64.whl (6.6 MB)\n","\u001b[K     |████████████████████████████████| 6.6 MB 50.6 MB/s \n","\u001b[?25hRequirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from transformers) (4.12.0)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (1.21.6)\n","Requirement already satisfied: packaging>=20.0 in /usr/local/lib/python3.7/dist-packages (from transformers) (21.3)\n","Requirement already satisfied: requests in /usr/local/lib/python3.7/dist-packages (from transformers) (2.23.0)\n","Requirement already satisfied: regex!=2019.12.17 in /usr/local/lib/python3.7/dist-packages (from transformers) (2022.6.2)\n","Collecting huggingface-hub<1.0,>=0.1.0\n","  Downloading huggingface_hub-0.9.1-py3-none-any.whl (120 kB)\n","\u001b[K     |████████████████████████████████| 120 kB 57.6 MB/s \n","\u001b[?25hRequirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from transformers) (3.8.0)\n","Requirement already satisfied: tqdm>=4.27 in /usr/local/lib/python3.7/dist-packages (from transformers) (4.64.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0,>=0.1.0->transformers) (4.1.1)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging>=20.0->transformers) (3.0.9)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->transformers) (3.8.1)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2022.6.15)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (1.24.3)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (2.10)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests->transformers) (3.0.4)\n","Installing collected packages: tokenizers, huggingface-hub, transformers\n","Successfully installed huggingface-hub-0.9.1 tokenizers-0.12.1 transformers-4.21.2\n"]}],"source":["!pip install transformers\n"]},{"cell_type":"code","source":["!pip install datasets"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SKQ9mWLzGaR3","executionInfo":{"status":"ok","timestamp":1662199208149,"user_tz":-180,"elapsed":9773,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"4132285f-545e-41de-a59f-a0a9ade77877"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Looking in indexes: https://pypi.org/simple, https://us-python.pkg.dev/colab-wheels/public/simple/\n","Collecting datasets\n","  Downloading datasets-2.4.0-py3-none-any.whl (365 kB)\n","\u001b[K     |████████████████████████████████| 365 kB 4.1 MB/s \n","\u001b[?25hRequirement already satisfied: pandas in /usr/local/lib/python3.7/dist-packages (from datasets) (1.3.5)\n","Requirement already satisfied: fsspec[http]>=2021.11.1 in /usr/local/lib/python3.7/dist-packages (from datasets) (2022.7.1)\n","Requirement already satisfied: dill<0.3.6 in /usr/local/lib/python3.7/dist-packages (from datasets) (0.3.5.1)\n","Requirement already satisfied: huggingface-hub<1.0.0,>=0.1.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (0.9.1)\n","Requirement already satisfied: tqdm>=4.62.1 in /usr/local/lib/python3.7/dist-packages (from datasets) (4.64.0)\n","Requirement already satisfied: pyarrow>=6.0.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (6.0.1)\n","Requirement already satisfied: numpy>=1.17 in /usr/local/lib/python3.7/dist-packages (from datasets) (1.21.6)\n","Collecting responses<0.19\n","  Downloading responses-0.18.0-py3-none-any.whl (38 kB)\n","Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.7/dist-packages (from datasets) (4.12.0)\n","Collecting multiprocess\n","  Downloading multiprocess-0.70.13-py37-none-any.whl (115 kB)\n","\u001b[K     |████████████████████████████████| 115 kB 39.4 MB/s \n","\u001b[?25hCollecting xxhash\n","  Downloading xxhash-3.0.0-cp37-cp37m-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (212 kB)\n","\u001b[K     |████████████████████████████████| 212 kB 68.1 MB/s \n","\u001b[?25hRequirement already satisfied: aiohttp in /usr/local/lib/python3.7/dist-packages (from datasets) (3.8.1)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.7/dist-packages (from datasets) (21.3)\n","Requirement already satisfied: requests>=2.19.0 in /usr/local/lib/python3.7/dist-packages (from datasets) (2.23.0)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (3.8.0)\n","Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (4.1.1)\n","Requirement already satisfied: pyyaml>=5.1 in /usr/local/lib/python3.7/dist-packages (from huggingface-hub<1.0.0,>=0.1.0->datasets) (6.0)\n","Requirement already satisfied: pyparsing!=3.0.5,>=2.0.2 in /usr/local/lib/python3.7/dist-packages (from packaging->datasets) (3.0.9)\n","Requirement already satisfied: urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (1.24.3)\n","Requirement already satisfied: idna<3,>=2.5 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (2.10)\n","Requirement already satisfied: certifi>=2017.4.17 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (2022.6.15)\n","Requirement already satisfied: chardet<4,>=3.0.2 in /usr/local/lib/python3.7/dist-packages (from requests>=2.19.0->datasets) (3.0.4)\n","Collecting urllib3!=1.25.0,!=1.25.1,<1.26,>=1.21.1\n","  Downloading urllib3-1.25.11-py2.py3-none-any.whl (127 kB)\n","\u001b[K     |████████████████████████████████| 127 kB 57.6 MB/s \n","\u001b[?25hRequirement already satisfied: asynctest==0.13.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (0.13.0)\n","Requirement already satisfied: aiosignal>=1.1.2 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (1.2.0)\n","Requirement already satisfied: charset-normalizer<3.0,>=2.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (2.1.1)\n","Requirement already satisfied: multidict<7.0,>=4.5 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (6.0.2)\n","Requirement already satisfied: async-timeout<5.0,>=4.0.0a3 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (4.0.2)\n","Requirement already satisfied: attrs>=17.3.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (22.1.0)\n","Requirement already satisfied: yarl<2.0,>=1.0 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (1.8.1)\n","Requirement already satisfied: frozenlist>=1.1.1 in /usr/local/lib/python3.7/dist-packages (from aiohttp->datasets) (1.3.1)\n","Requirement already satisfied: zipp>=0.5 in /usr/local/lib/python3.7/dist-packages (from importlib-metadata->datasets) (3.8.1)\n","Requirement already satisfied: pytz>=2017.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2022.2.1)\n","Requirement already satisfied: python-dateutil>=2.7.3 in /usr/local/lib/python3.7/dist-packages (from pandas->datasets) (2.8.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.7/dist-packages (from python-dateutil>=2.7.3->pandas->datasets) (1.15.0)\n","Installing collected packages: urllib3, xxhash, responses, multiprocess, datasets\n","  Attempting uninstall: urllib3\n","    Found existing installation: urllib3 1.24.3\n","    Uninstalling urllib3-1.24.3:\n","      Successfully uninstalled urllib3-1.24.3\n","Successfully installed datasets-2.4.0 multiprocess-0.70.13 responses-0.18.0 urllib3-1.25.11 xxhash-3.0.0\n"]}]},{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"FWAhQj037vgu","executionInfo":{"status":"ok","timestamp":1662199254467,"user_tz":-180,"elapsed":46334,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"1a0546cb-bc3e-4db1-89d0-7eafe76e8687"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Drive already mounted at /content/drive; to attempt to forcibly remount, call drive.mount(\"/content/drive\", force_remount=True).\n"]}]},{"cell_type":"markdown","source":["#Setup"],"metadata":{"id":"ahrMmzD7TlCE"}},{"cell_type":"code","source":["epochs = 3\n","batch_size = 32\n","model_checkpoint = \"DeepPavlov/rubert-base-cased-conversational\""],"metadata":{"id":"tTT91ZQ7hbRV"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import tensorflow as tf\n","import pandas as pd\n","\n","from datasets import load_dataset, load_metric"],"metadata":{"id":"w9W-ccZG4zev"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["#Getting and preparing data"],"metadata":{"id":"1PuORkR0TrHP"}},{"cell_type":"code","source":["emotion_labels = pd.read_csv('/content/drive/MyDrive/SentiChallenge/emotion_dict.csv', header=None)"],"metadata":{"id":"nSZ8Vb_-TDGn"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["emotion_labels = emotion_labels.iloc[:,0].tolist()"],"metadata":{"id":"rW8Hu4RtTwVG"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_dev = pd.read_csv('/content/drive/MyDrive/SentiChallenge/translated/dev.tsv', sep='\\t')\n","df_test = pd.read_csv('/content/drive/MyDrive/SentiChallenge/translated/test.tsv', sep='\\t')\n","df_train = pd.read_csv('/content/drive/MyDrive/SentiChallenge/translated/train.tsv', sep='\\t')"],"metadata":{"id":"hVrXt46MxOT9"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_dev = df_dev.drop(columns=['Unnamed: 0'])\n","df_test = df_test.drop(columns=['Unnamed: 0'])\n","df_train = df_train.drop(columns=['Unnamed: 0'])"],"metadata":{"id":"5XdCVODKzAbc"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["df_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"CxtfFaBm338w","executionInfo":{"status":"ok","timestamp":1662199261447,"user_tz":-180,"elapsed":7,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"29e8c9bb-80f1-4f23-d47a-9c5f95f8a735"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                    text  \\\n","0      My favourite food is anything I didn't have to...   \n","1      Now if he does off himself, everyone will thin...   \n","2                         WHY THE FUCK IS BAYLESS ISOING   \n","3                            To make her feel threatened   \n","4                                 Dirty Southern Wankers   \n","...                                                  ...   \n","27995  I literally teared up reading this. That poor,...   \n","27996  Who specifically are we gonna sue? The industr...   \n","27997  Crack whores are hooking in broad daylight now...   \n","27998  Sorry if Im slow here but what does Milan or [...   \n","27999  Hey, Is this in Portugal? I recognize the fran...   \n","\n","                                                 text_ru emotions       id  \n","0      Моя любимая еда - это все, что мне не приходил...       27  eebbqej  \n","1      Теперь, если он покончит с собой, все подумают...       27  ed00q6i  \n","2                         КАКОГО ХРЕНА БЭЙЛЕСС ДЕРГАЕТСЯ        2  eezlygj  \n","3                Чтобы заставить ее почувствовать угрозу       14  ed7ypvh  \n","4                                  Грязные Южные Дрочеры        3  ed0bdzj  \n","...                                                  ...      ...      ...  \n","27995  Я буквально расплакалась, читая это. Этот бедн...     0,25  efcknur  \n","27996  На кого конкретно мы будем подавать в суд? Инд...        1  eeqiyt9  \n","27997     Крэк-шлюхи теперь трахаются средь бела дня, а?        7  eetfn7z  \n","27998  Извините, если я медлю здесь, но какое отношен...       24  efcfzbx  \n","27999  Эй, это в Португалии? Я узнаю соус франсезинья...        7  ed0bf06  \n","\n","[28000 rows x 4 columns]"],"text/html":["\n","  <div id=\"df-912eb224-1cfd-442f-b727-eaa69598ee72\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text</th>\n","      <th>text_ru</th>\n","      <th>emotions</th>\n","      <th>id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>My favourite food is anything I didn't have to...</td>\n","      <td>Моя любимая еда - это все, что мне не приходил...</td>\n","      <td>27</td>\n","      <td>eebbqej</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Now if he does off himself, everyone will thin...</td>\n","      <td>Теперь, если он покончит с собой, все подумают...</td>\n","      <td>27</td>\n","      <td>ed00q6i</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>WHY THE FUCK IS BAYLESS ISOING</td>\n","      <td>КАКОГО ХРЕНА БЭЙЛЕСС ДЕРГАЕТСЯ</td>\n","      <td>2</td>\n","      <td>eezlygj</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>To make her feel threatened</td>\n","      <td>Чтобы заставить ее почувствовать угрозу</td>\n","      <td>14</td>\n","      <td>ed7ypvh</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Dirty Southern Wankers</td>\n","      <td>Грязные Южные Дрочеры</td>\n","      <td>3</td>\n","      <td>ed0bdzj</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>27995</th>\n","      <td>I literally teared up reading this. That poor,...</td>\n","      <td>Я буквально расплакалась, читая это. Этот бедн...</td>\n","      <td>0,25</td>\n","      <td>efcknur</td>\n","    </tr>\n","    <tr>\n","      <th>27996</th>\n","      <td>Who specifically are we gonna sue? The industr...</td>\n","      <td>На кого конкретно мы будем подавать в суд? Инд...</td>\n","      <td>1</td>\n","      <td>eeqiyt9</td>\n","    </tr>\n","    <tr>\n","      <th>27997</th>\n","      <td>Crack whores are hooking in broad daylight now...</td>\n","      <td>Крэк-шлюхи теперь трахаются средь бела дня, а?</td>\n","      <td>7</td>\n","      <td>eetfn7z</td>\n","    </tr>\n","    <tr>\n","      <th>27998</th>\n","      <td>Sorry if Im slow here but what does Milan or [...</td>\n","      <td>Извините, если я медлю здесь, но какое отношен...</td>\n","      <td>24</td>\n","      <td>efcfzbx</td>\n","    </tr>\n","    <tr>\n","      <th>27999</th>\n","      <td>Hey, Is this in Portugal? I recognize the fran...</td>\n","      <td>Эй, это в Португалии? Я узнаю соус франсезинья...</td>\n","      <td>7</td>\n","      <td>ed0bf06</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28000 rows × 4 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-912eb224-1cfd-442f-b727-eaa69598ee72')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-912eb224-1cfd-442f-b727-eaa69598ee72 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-912eb224-1cfd-442f-b727-eaa69598ee72');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["df_dev_emotions = [x.split(',') for x in df_dev['emotions'].tolist()]\n","df_test_emotions = [x.split(',') for x in df_test['emotions'].tolist()]\n","df_train_emotions = [x.split(',') for x in df_train['emotions'].tolist()]"],"metadata":{"id":"SkbnQQOhuQxx"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import collections\n","collections.Counter([len(x) for x in df_dev_emotions])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"IrlHXqM2vQC_","executionInfo":{"status":"ok","timestamp":1662199261954,"user_tz":-180,"elapsed":7,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"c5616a57-2fe4-40d7-85fc-43c7b2d3f3c0"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["Counter({1: 4548, 2: 809, 3: 62, 4: 7})"]},"metadata":{},"execution_count":10}]},{"cell_type":"code","source":["df_dev_emotions = [x.split(',')[0] for x in df_dev['emotions'].tolist()]\n","df_test_emotions = [x.split(',')[0] for x in df_test['emotions'].tolist()]\n","df_train_emotions = [x.split(',')[0] for x in df_train['emotions'].tolist()]"],"metadata":{"id":"5RYmDbOO7Sxx"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["len(np.unique(df_train_emotions))"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"_9PhySbRzU6U","executionInfo":{"status":"ok","timestamp":1662199395160,"user_tz":-180,"elapsed":362,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"508fa49a-d9e9-4f82-c862-4a786d6614e4"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["28"]},"metadata":{},"execution_count":24}]},{"cell_type":"code","source":["df_dev = df_dev.drop(columns=['text', 'id'])\n","df_dev['emotions'] = df_dev_emotions\n","\n","df_test = df_test.drop(columns=['text', 'id'])\n","df_test['emotions'] = df_test_emotions\n","\n","df_train = df_train.drop(columns=['text', 'id'])\n","df_train['emotions'] = df_train_emotions"],"metadata":{"id":"mn_BbG_1AztD"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["import matplotlib.pyplot as plt\n","import numpy as np\n","\n","plt.figure(figsize = (20,8))\n","plt.title(\"Classes distribution\")\n","df_train['emotions'].value_counts().plot(kind='bar')\n","plt.grid()\n","plt.show() "],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":502},"id":"lIuWym6Lf7Qh","executionInfo":{"status":"ok","timestamp":1662199810153,"user_tz":-180,"elapsed":1488,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"7e2ee14b-a51b-4018-ff6c-f318d1ea11d1"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["<Figure size 1440x576 with 1 Axes>"],"image/png":"iVBORw0KGgoAAAANSUhEUgAABIoAAAHlCAYAAACaixfdAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAALEgAACxIB0t1+/AAAADh0RVh0U29mdHdhcmUAbWF0cGxvdGxpYiB2ZXJzaW9uMy4yLjIsIGh0dHA6Ly9tYXRwbG90bGliLm9yZy+WH4yJAAAgAElEQVR4nOzdfbRmZ1km+OuWEhMoTcKHZ8VK7GCTsRuogSHVCY6umSqjIQTHMD1KR9NSodOT7mX8amM3hSMdmg8n9oAoq1tnZUw0oE0ZowyRgJgOVNuuNUAMKIEgpoCEpAxBSVJYEGkL7/njPIFjcSrnrXefqvMm+f3WOuu877Ofvfe1K4skXHn23tXdAQAAAICv2egAAAAAACwGRREAAAAASRRFAAAAAAyKIgAAAACSKIoAAAAAGBRFAAAAACRRFAEAG6yqXllVv77ROY5UVXVVPX18/r+r6hXrdNxvrqoDVfW48X1PVf3z9Tj2ON47q2rneh0PAHh0URQBAEddVf1gVf3RKEDuGWXFd2x0rvXS3f+yu1+91ryquqOqvmuNY32quzd395em5lqthOvuF3T3NVOPDQA8OimKAICjqqp+MskvJPnZJEtJvjnJLyU5fyNzLaKq2rTRGQCAxzZFEQBw1FTVCUleleTS7v6d7v58d/9Nd/9ud//rw+zzW1X16araX1V/UFXPXLHtvKq6rar+qqr2VdVPjfGnVNXbq+qBqrqvqv5rVX3N2PZNVfXbVfUXVfXJqvqxFcc7c6x0+lxV3VtVP/8w1/Kvx2qoP6+qf3bItl+rqtc8XJaqenOWS7LfHSur/k1VnTZuYbu4qj6V5N0rxlaWRn+/qt4/cr6tqp40zrW9qu4+JMsdVfVdVXVukp9O8k/G+f5kbP/yrWwj189U1Z1V9ZmqetP4a5YVOXZW1aeq6i+r6v94uL/eAMAjn6IIADiavi3JcUneegT7vDPJ6Um+MckHkvzGim1XJfkX3f31SZ6V5N1j/LIkdyd5apZXLf10kh5l0e8m+ZMkW5KcneQnqur5Y79fTPKL3f0NSf5+kmtXCzRKl59K8t0j28PdPrZqlu7+oSSfSvK/jFvL/v2Kff7nJP8wyfMPPdjwkiT/LMnJSQ4meePDnD9ZPuHvZXkV12+O8z17lWkXjZ8dSb4lyeYk/+GQOd+R5Fuz/Gf3b6vqH651bgDgkUtRBAAcTU9O8pfdfXDWHbr76u7+q+7+YpJXJnn2Q6tckvxNkmdU1Td09/3d/YEV4ycn+XtjxdJ/7e5O8o+SPLW7X9Xd/627P5Hk/0lywYr9nl5VT+nuA9393sPEenGSX+3uD3f350euwzlclofzyrHa6sHDbH/zinO/IsmLH3rY9UQXJvn57v5Edx9I8vIkFxyymunfdfeD3f0nWS7cViucAIBHCUURAHA0fTbJU2Z99k5VPa6qrqiqj1fV55LcMTY9Zfz+35Kcl+TOqvovVfVtY/z/SrI3ye9X1SeqatcY/3tJvmncBvZAVT2Q5RU+S2P7xUn+uyR/WlU3V9X3HCbaNyW5a8X3Ox/mMg6X5eHcdQTb70zytfnKn8kU35S/ey13JtmUr/z5JMmnV3z+QpZXHQEAj1KKIgDgaPr/knwxyYtmnP+DWX7I9XclOSHJaWO8kqS7b+7u87N8W9r/m3Gr2FiBdFl3f0uS703yk1V1dpYLlk9294krfr6+u88b+93e3T8wjvdzSa6rqieukuueJKeu+P7Nh7uAh8mSJIdbWbTWiqNDz/03Sf4yyeeTPOGhDWOV0VOP4Lh/nuUybeWxDya5d439AIBHKUURAHDUdPf+JP82yX+sqhdV1ROq6mur6gVV9e9X2eXrs1wsfTbLBcjPPrShqh5fVRdW1Qnd/TdJPpfkb8e276mqp1dVJdmf5Etj2/uT/FVVvayqjh8rlp5VVf9o7PdPq+qp3f23SR4Yp/rbVXJdm+SiqnpGVT0hyeWHu+aHyZIsFzDfsvaf3Ff5pyvO/aok13X3l5L8WZLjquqFVfW1SX4mydet2O/eJKc99GDvVbwlyb+qqqdV1eZ85ZlGM98qCAA8uiiKAICjqrtfn+Qns1xi/EWWV/n8SJZXBB3qTVm+/WlfktuSHPrMoB9Kcse4Le1fZvkZO8nyA6b/c5IDWV7F9Evd/Z5RpnxPkuck+WSWV+H8SpZXKyXJuUk+UlUHsvxg6wtWe05Qd78zyS9k+eHZe/OVh2ivZtUsY9v/meRnxm1wP/UwxzjUm5P8WpZvAzsuyY+NXPuT/PC4pn1ZXmG08i1ovzV+f7aqPpCvdvU49h9k+c/nr5P86BHkAgAeZWrtZysCAAAA8FhgRREAAAAASRRFAAAAAAyKIgAAAACSKIoAAAAAGBRFAAAAACRJNm10gIfzlKc8pU877bR1O97nP//5PPGJT1y34603+aaRb5pFzrfI2RL5ppJvGvnmt8jZEvmmkm8a+ea3yNkS+aaSbxr55rfe2W655Za/7O6nrrqxuxf254wzzuj19J73vGddj7fe5JtGvmkWOd8iZ+uWbyr5ppFvfoucrVu+qeSbRr75LXK2bvmmkm8a+ea33tmS/FEfpotx6xkAAAAASTyjCAAAAIBBUQQAAABAEkURAAAAAIOiCAAAAIAkiiIAAAAABkURAAAAAEkURQAAAAAMiiIAAAAAkiiKAAAAABgURQAAAAAkURQBAAAAMCiKAAAAAEiiKAIAAABgUBQBAAAAkERRBAAAAMCgKAIAAAAgiaIIAAAAgEFRBAAAAECSZNNGB1gPp+26YaZ5l209mItmmHvHFS+cGgkAAADgEceKIgAAAACSKIoAAAAAGBRFAAAAACRRFAEAAAAwKIoAAAAASKIoAgAAAGBQFAEAAACQRFEEAAAAwKAoAgAAACCJoggAAACAQVEEAAAAQJIZi6Kq+ldV9ZGq+nBVvaWqjquqp1XV+6pqb1X9ZlU9fsz9uvF979h+2orjvHyMf6yqnn90LgkAAACAeaxZFFXVliQ/lmRbdz8ryeOSXJDk55K8obufnuT+JBePXS5Ocv8Yf8OYl6p6xtjvmUnOTfJLVfW49b0cAAAAAOY1661nm5IcX1WbkjwhyT1JvjPJdWP7NUleND6fP75nbD+7qmqM7+7uL3b3J5PsTXLm9EsAAAAAYD2sWRR1974kr0vyqSwXRPuT3JLkge4+OKbdnWTL+LwlyV1j34Nj/pNXjq+yDwAAAAAbrLr74SdUnZTkt5P8kyQPJPmtLK8UeuW4vSxVdWqSd3b3s6rqw0nO7e67x7aPJzkrySuTvLe7f32MXzX2ue6Q812S5JIkWVpaOmP37t1rXsSt+/bPdLFLxyf3Prj2vK1bTpjpeOvtwIED2bx584acexbyTSPf/BY5WyLfVPJNI9/8FjlbIt9U8k0j3/wWOVsi31TyTSPf/NY7244dO27p7m2rbds0w/7fleST3f0XSVJVv5Pk25OcWFWbxqqhU5LsG/P3JTk1yd3jVrUTknx2xfhDVu7zZd19ZZIrk2Tbtm29ffv2NQNetOuGGS4juWzrwbz+1rUv+Y4L1z7n0bBnz57Mcr0bRb5p5JvfImdL5JtKvmnkm98iZ0vkm0q+aeSb3yJnS+SbSr5p5Jvfscw2yzOKPpXkeVX1hPGsobOT3JbkPUm+b8zZmeRt4/P143vG9nf38rKl65NcMN6K9rQkpyd5//pcBgAAAABTrbm8prvfV1XXJflAkoNJPpjlFT83JNldVa8ZY1eNXa5K8uaq2pvkviy/6Szd/ZGqujbLJdPBJJd295fW+XoAAAAAmNMst56luy9Pcvkhw5/IKm8t6+6/TvL9hznOa5O89ggzAgAAAHAMzHLrGQAAAACPAYoiAAAAAJIoigAAAAAYFEUAAAAAJFEUAQAAADAoigAAAABIoigCAAAAYFAUAQAAAJBEUQQAAADAoCgCAAAAIImiCAAAAIBBUQQAAABAEkURAAAAAIOiCAAAAIAkiiIAAAAABkURAAAAAEkURQAAAAAMiiIAAAAAkiiKAAAAABgURQAAAAAkURQBAAAAMCiKAAAAAEiiKAIAAABgUBQBAAAAkERRBAAAAMCgKAIAAAAgiaIIAAAAgEFRBAAAAEASRREAAAAAg6IIAAAAgCSKIgAAAAAGRREAAAAASRRFAAAAAAyKIgAAAACSKIoAAAAAGBRFAAAAACRRFAEAAAAwKIoAAAAASKIoAgAAAGBQFAEAAACQRFEEAAAAwLBmUVRV31pVf7zi53NV9RNV9aSqurGqbh+/Txrzq6reWFV7q+pDVfXcFcfaOebfXlU7j+aFAQAAAHBk1iyKuvtj3f2c7n5OkjOSfCHJW5PsSnJTd5+e5KbxPUlekOT08XNJkl9Okqp6UpLLk5yV5Mwklz9ULgEAAACw8Y701rOzk3y8u+9Mcn6Sa8b4NUleND6fn+RNvey9SU6sqpOTPD/Jjd19X3ffn+TGJOdOvgIAAAAA1sWRFkUXJHnL+LzU3feMz59OsjQ+b0ly14p97h5jhxsHAAAAYAFUd882serxSf48yTO7+96qeqC7T1yx/f7uPqmq3p7kiu7+wzF+U5KXJdme5Ljufs0Yf0WSB7v7dYec55Is37KWpaWlM3bv3r1mtlv37Z/pGpaOT+59cO15W7ecMNPx1tuBAweyefPmDTn3LOSbRr75LXK2RL6p5JtGvvktcrZEvqnkm0a++S1ytkS+qeSbRr75rXe2HTt23NLd21bbtukIjvOCJB/o7nvH93ur6uTuvmfcWvaZMb4vyakr9jtljO3Lclm0cnzPoSfp7iuTXJkk27Zt6+3btx865atctOuGmS7gsq0H8/pb177kOy5c+5xHw549ezLL9W4U+aaRb36LnC2Rbyr5ppFvfoucLZFvKvmmkW9+i5wtkW8q+aaRb37HMtuR3Hr2A/nKbWdJcn2Sh95ctjPJ21aMv2S8/ex5SfaPW9TeleScqjppPMT6nDEGAAAAwAKYaUVRVT0xyXcn+Rcrhq9Icm1VXZzkziQvHuPvSHJekr1ZfkPaS5Oku++rqlcnuXnMe1V33zf5CgAAAABYFzMVRd39+SRPPmTss1l+C9qhczvJpYc5ztVJrj7ymAAAAAAcbUf61jMAAAAAHqUURQAAAAAkURQBAAAAMCiKAAAAAEiiKAIAAABgUBQBAAAAkERRBAAAAMCgKAIAAAAgiaIIAAAAgEFRBAAAAEASRREAAAAAg6IIAAAAgCSKIgAAAAAGRREAAAAASRRFAAAAAAyKIgAAAACSKIoAAAAAGBRFAAAAACRRFAEAAAAwKIoAAAAASKIoAgAAAGBQFAEAAACQRFEEAAAAwKAoAgAAACCJoggAAACAQVEEAAAAQBJFEQAAAACDoggAAACAJIoiAAAAAAZFEQAAAABJFEUAAAAADIoiAAAAAJIoigAAAAAYFEUAAAAAJFEUAQAAADAoigAAAABIoigCAAAAYFAUAQAAAJBEUQQAAADAoCgCAAAAIMmMRVFVnVhV11XVn1bVR6vq26rqSVV1Y1XdPn6fNOZWVb2xqvZW1Yeq6rkrjrNzzL+9qnYerYsCAAAA4MjNuqLoF5P8Xnf/gyTPTvLRJLuS3NTdpye5aXxPkhckOX38XJLkl5Okqp6U5PIkZyU5M8nlD5VLAAAAAGy8NYuiqjohyf+U5Kok6e7/1t0PJDk/yTVj2jVJXjQ+n5/kTb3svUlOrKqTkzw/yY3dfV9335/kxiTnruvVAAAAADC3WVYUPS3JXyT51ar6YFX9SlU9MclSd98z5nw6ydL4vCXJXSv2v3uMHW4cAAAAgAVQ3f3wE6q2JXlvkm/v7vdV1S8m+VySH+3uE1fMu7+7T6qqtye5orv/cIzflORlSbYnOa67XzPGX5Hkwe5+3SHnuyTLt6xlaWnpjN27d695Ebfu2z/TxS4dn9z74Nrztm45YabjrbcDBw5k8+bNG3LuWcg3jXzzW+RsiXxTyTeNfPNb5GyJfFPJN41881vkbIl8U8k3jXzzW+9sO3bsuKW7t622bdMM+9+d5O7uft/4fl2Wn0d0b1Wd3N33jFvLPjO270ty6or9Txlj+7JcFq0c33Poybr7yiRXJsm2bdt6+/bth075KhftumGGy0gu23owr7917Uu+48K1z3k07NmzJ7Nc70aRbxr55rfI2RL5ppJvGvnmt8jZEvmmkm8a+ea3yNkS+aaSbxr55ncss61561l3fzrJXVX1rWPo7CS3Jbk+yUNvLtuZ5G3j8/VJXjLefva8JPvHLWrvSnJOVZ00HmJ9zhgDAAAAYAHMsqIoSX40yW9U1eOTfCLJS7NcMl1bVRcnuTPJi8fcdyQ5L8neJF8Yc9Pd91XVq5PcPOa9qrvvW5erAAAAAGCymYqi7v7jJKvdu3b2KnM7yaWHOc7VSa4+koAAAAAAHBuzvPUMAAAAgMcARREAAAAASRRFAAAAAAyKIgAAAACSKIoAAAAAGBRFAAAAACRRFAEAAAAwKIoAAAAASKIoAgAAAGBQFAEAAACQRFEEAAAAwKAoAgAAACCJoggAAACAQVEEAAAAQBJFEQAAAACDoggAAACAJIoiAAAAAAZFEQAAAABJFEUAAAAADIoiAAAAAJIoigAAAAAYFEUAAAAAJFEUAQAAADAoigAAAABIoigCAAAAYFAUAQAAAJBEUQQAAADAoCgCAAAAIImiCAAAAIBBUQQAAABAEkURAAAAAIOiCAAAAIAkiiIAAAAABkURAAAAAEkURQAAAAAMiiIAAAAAkiiKAAAAABgURQAAAAAkURQBAAAAMCiKAAAAAEiiKAIAAABgmKkoqqo7qurWqvrjqvqjMfakqrqxqm4fv08a41VVb6yqvVX1oap67orj7Bzzb6+qnUfnkgAAAACYx5GsKNrR3c/p7m3j+64kN3X36UluGt+T5AVJTh8/lyT55WS5WEpyeZKzkpyZ5PKHyiUAAAAANt6UW8/OT3LN+HxNkhetGH9TL3tvkhOr6uQkz09yY3ff1933J7kxybkTzg8AAADAOpq1KOokv19Vt1TVJWNsqbvvGZ8/nWRpfN6S5K4V+949xg43DgAAAMACqO5ee1LVlu7eV1XfmOWVQD+a5PruPnHFnPu7+6SqenuSK7r7D8f4TUlelmR7kuO6+zVj/BVJHuzu1x1yrkuyfMtalpaWzti9e/ea+W7dt3+Wa83S8cm9D649b+uWE2Y63no7cOBANm/evCHnnoV808g3v0XOlsg3lXzTyDe/Rc6WyDeVfNPIN79FzpbIN5V808g3v/XOtmPHjltWPFro79g0ywG6e9/4/ZmqemuWnzF0b1Wd3N33jFvLPjOm70ty6ordTxlj+7JcFq0c37PKua5McmWSbNu2rbdv337olK9y0a4bZrmMXLb1YF5/69qXfMeFa5/zaNizZ09mud6NIt808s1vkbMl8k0l3zTyzW+RsyXyTSXfNPLNb5GzJfJNJd808s3vWGZb89azqnpiVX39Q5+TnJPkw0muT/LQm8t2Jnnb+Hx9kpeMt589L8n+cYvau5KcU1UnjYdYnzPGAAAAAFgAs6woWkry1qp6aP5/6u7fq6qbk1xbVRcnuTPJi8f8dyQ5L8neJF9I8tIk6e77qurVSW4e817V3fet25UAAAAAMMmaRVF3fyLJs1cZ/2ySs1cZ7ySXHuZYVye5+shjAgAAAHC0zfrWMwAAAAAe5RRFAAAAACRRFAEAAAAwKIoAAAAASKIoAgAAAGBQFAEAAACQRFEEAAAAwKAoAgAAACCJoggAAACAQVEEAAAAQBJFEQAAAACDoggAAACAJIoiAAAAAAZFEQAAAABJFEUAAAAADIoiAAAAAJIoigAAAAAYFEUAAAAAJFEUAQAAADAoigAAAABIoigCAAAAYFAUAQAAAJBEUQQAAADAoCgCAAAAIImiCAAAAIBBUQQAAABAEkURAAAAAIOiCAAAAIAkiiIAAAAABkURAAAAAEkURQAAAAAMiiIAAAAAkiiKAAAAABgURQAAAAAkURQBAAAAMCiKAAAAAEiiKAIAAABgUBQBAAAAkERRBAAAAMCgKAIAAAAgiaIIAAAAgGHmoqiqHldVH6yqt4/vT6uq91XV3qr6zap6/Bj/uvF979h+2opjvHyMf6yqnr/eFwMAAADA/I5kRdGPJ/noiu8/l+QN3f30JPcnuXiMX5zk/jH+hjEvVfWMJBckeWaSc5P8UlU9blp8AAAAANbLTEVRVZ2S5IVJfmV8ryTfmeS6MeWaJC8an88f3zO2nz3mn59kd3d/sbs/mWRvkjPX4yIAAAAAmG7WFUW/kOTfJPnb8f3JSR7o7oPj+91JtozPW5LclSRj+/4x/8vjq+wDAAAAwAar7n74CVXfk+S87v7hqtqe5KeSXJTkveP2slTVqUne2d3PqqoPJzm3u+8e2z6e5Kwkrxz7/PoYv2rsc90h57skySVJsrS0dMbu3bvXvIhb9+2f6WKXjk/ufXDteVu3nDDT8dbbgQMHsnnz5g059yzkm0a++S1ytkS+qeSbRr75LXK2RL6p5JtGvvktcrZEvqnkm0a++a13th07dtzS3dtW27Zphv2/Pcn3VtV5SY5L8g1JfjHJiVW1aawaOiXJvjF/X5JTk9xdVZuSnJDksyvGH7Jyny/r7iuTXJkk27Zt6+3bt68Z8KJdN8xwGcllWw/m9beufcl3XLj2OY+GPXv2ZJbr3SjyTSPf/BY5WyLfVPJNI9/8FjlbIt9U8k0j3/wWOVsi31TyTSPf/I5ltjVvPevul3f3Kd19WpYfRv3u7r4wyXuSfN+YtjPJ28bn68f3jO3v7uVlS9cnuWC8Fe1pSU5P8v51uxIAAAAAJpllRdHhvCzJ7qp6TZIPJrlqjF+V5M1VtTfJfVkul9LdH6mqa5PcluRgkku7+0sTzg8AAADAOjqioqi79yTZMz5/Iqu8tay7/zrJ9x9m/9cmee2RhgQAAADg6Jv1rWcAAAAAPMopigAAAABIoigCAAAAYFAUAQAAAJBEUQQAAADAoCgCAAAAIImiCAAAAIBBUQQAAABAEkURAAAAAIOiCAAAAIAkiiIAAAAABkURAAAAAEkURQAAAAAMiiIAAAAAkiiKAAAAABgURQAAAAAkURQBAAAAMCiKAAAAAEiiKAIAAABgUBQBAAAAkERRBAAAAMCgKAIAAAAgiaIIAAAAgEFRBAAAAEASRREAAAAAg6IIAAAAgCSKIgAAAAAGRREAAAAASRRFAAAAAAyKIgAAAACSKIoAAAAAGBRFAAAAACRRFAEAAAAwKIoAAAAASKIoAgAAAGBQFAEAAACQRFEEAAAAwKAoAgAAACCJoggAAACAQVEEAAAAQBJFEQAAAADDmkVRVR1XVe+vqj+pqo9U1b8b40+rqvdV1d6q+s2qevwY/7rxfe/YftqKY718jH+sqp5/tC4KAAAAgCM3y4qiLyb5zu5+dpLnJDm3qp6X5OeSvKG7n57k/iQXj/kXJ7l/jL9hzEtVPSPJBUmemeTcJL9UVY9bz4sBAAAAYH5rFkW97MD4+rXjp5N8Z5Lrxvg1SV40Pp8/vmdsP7uqaozv7u4vdvcnk+xNcua6XAUAAAAAk830jKKqelxV/XGSzyS5McnHkzzQ3QfHlLuTbBmftyS5K0nG9v1JnrxyfJV9AAAAANhg1d2zT646Mclbk7wiya+N28tSVacmeWd3P6uqPpzk3O6+e2z7eJKzkrwyyXu7+9fH+FVjn+sOOcclSS5JkqWlpTN27969Zq5b9+2fKf/S8cm9D649b+uWE2Y63no7cOBANm/evCHnnoV808g3v0XOlsg3lXzTyDe/Rc6WyDeVfNPIN79FzpbIN5V808g3v/XOtmPHjlu6e9tq2zYdyYG6+4Gqek+Sb0tyYlVtGquGTkmyb0zbl+TUJHdX1aYkJyT57Irxh6zcZ+U5rkxyZZJs27att2/fvmaui3bdMFP+y7YezOtvXfuS77hw7XMeDXv27Mks17tR5JtGvvktcrZEvqnkm0a++S1ytkS+qeSbRr75LXK2RL6p5JtGvvkdy2yzvPXsqWMlUarq+CTfneSjSd6T5PvGtJ1J3jY+Xz++Z2x/dy8vW7o+yQXjrWhPS3J6kvev14UAAAAAMM0sK4pOTnLNeEPZ1yS5trvfXlW3JdldVa9J8sEkV435VyV5c1XtTXJflt90lu7+SFVdm+S2JAeTXNrdX1rfywEAAABgXmsWRd39oST/wyrjn8gqby3r7r9O8v2HOdZrk7z2yGMCAAAAcLTN9NYzAAAAAB79FEUAAAAAJFEUAQAAADAoigAAAABIoigCAAAAYFAUAQAAAJBEUQQAAADAoCgCAAAAIImiCAAAAIBBUQQAAABAEkURAAAAAIOiCAAAAIAkyaaNDvBYcNquG2aad9nWg7lohrl3XPHCqZEAAAAAvooVRQAAAAAkURQBAAAAMCiKAAAAAEiiKAIAAABgUBQBAAAAkERRBAAAAMCgKAIAAAAgiaIIAAAAgEFRBAAAAEASRREAAAAAg6IIAAAAgCSKIgAAAAAGRREAAAAASRRFAAAAAAyKIgAAAACSKIoAAAAAGBRFAAAAACRRFAEAAAAwKIoAAAAASKIoAgAAAGBQFAEAAACQRFEEAAAAwKAoAgAAACCJoggAAACAQVEEAAAAQBJFEQAAAACDoggAAACAJIoiAAAAAIY1i6KqOrWq3lNVt1XVR6rqx8f4k6rqxqq6ffw+aYxXVb2xqvZW1Yeq6rkrjrVzzL+9qnYevcsCAAAA4EjNsqLoYJLLuvsZSZ6X5NKqekaSXUlu6u7Tk9w0vifJC5KcPn4uSfLLyXKxlOTyJGclOTPJ5Q+VSwAAAABsvDWLou6+p7s/MD7/VZKPJtmS5Pwk14xp1yR50fh8fpI39bL3Jjmxqk5O8vwkN3b3fd19f5Ibk5y7rlcDAAAAwNyqu2efXHVakj9I8qwkn+ruE8d4Jbm/u0+sqrcnuaK7/3BsuynJy5JsT3Jcd79mjL8iyYPd/bpDznFJllciZWlp6Yzdu3evmevWfftnyr90fHLvg2vP27rlhJmON6tFzzerAwcOZPPmzRty7lnIN80i51vkbIl8U8k3jXzzW+RsiXxTyetYN+oAABT0SURBVDeNfPNb5GyJfFPJN41881vvbDt27Lilu7ettm3TrAepqs1JfjvJT3T355a7oWXd3VU1e+P0MLr7yiRXJsm2bdt6+/bta+5z0a4bZjr2ZVsP5vW3rn3Jd1y49jmPxKLnm9WePXsyy1+PjSLfNIucb5GzJfJNJd808s1vkbMl8k0l3zTyzW+RsyXyTSXfNPLN71hmm+mtZ1X1tVkuiX6ju39nDN87binL+P2ZMb4vyakrdj9ljB1uHAAAAIAFMMtbzyrJVUk+2t0/v2LT9UkeenPZziRvWzH+kvH2s+cl2d/d9yR5V5Jzquqk8RDrc8YYAAAAAAtgllvPvj3JDyW5tar+eIz9dJIrklxbVRcnuTPJi8e2dyQ5L8neJF9I8tIk6e77qurVSW4e817V3fety1UAAAAAMNmaRdF4KHUdZvPZq8zvJJce5lhXJ7n6SAICAAAAcGzM9IwiAAAAAB79FEUAAAAAJFEUAQAAADAoigAAAABIoigCAAAAYFAUAQAAAJBEUQQAAADAoCgCAAAAIImiCAAAAIBBUQQAAABAEkURAAAAAMOmjQ7Axjtt1w0zzbts68FcNMPcO6544dRIAAAAwAawoggAAACAJIoiAAAAAAZFEQAAAABJFEUAAAAADIoiAAAAAJIoigAAAAAYFEUAAAAAJFEUAQAAADAoigAAAABIoigCAAAAYFAUAQAAAJAk2bTRAWAtp+26YaZ5l209mItmmHvHFS+cGgkAAAAelawoAgAAACCJFUUwmRVPAAAAPFpYUQQAAABAEiuK4FHPiicAAABmZUURAAAAAEkURQAAAAAMiiIAAAAAkiiKAAAAABgURQAAAAAkURQBAAAAMCiKAAAAAEiiKAIAAABgUBQBAAAAkCTZtNEBgMeu03bdMNO8y7YezEUzzL3jihdOjQQAAPCYZkURAAAAAEkURQAAAAAMaxZFVXV1VX2mqj68YuxJVXVjVd0+fp80xquq3lhVe6vqQ1X13BX77Bzzb6+qnUfncgAAAACY1yzPKPq1JP8hyZtWjO1KclN3X1FVu8b3lyV5QZLTx89ZSX45yVlV9aQklyfZlqST3FJV13f3/et1IQDrzTOUAACAx5o1VxR19x8kue+Q4fOTXDM+X5PkRSvG39TL3pvkxKo6Ocnzk9zY3feNcujGJOeuxwUAAAAAsD7mfUbRUnffMz5/OsnS+LwlyV0r5t09xg43DgAAAMCCqO5ee1LVaUne3t3PGt8f6O4TV2y/v7tPqqq3J7miu/9wjN+U5VvStic5rrtfM8ZfkeTB7n7dKue6JMklSbK0tHTG7t2718x36779a85JkqXjk3sfXHve1i0nzHS8Wck3jXzTLHK+Rc6WyHesHDhwIJs3b96Qc89CvmkWOd8iZ0vkm0q+aeSb3yJnS+SbSr5p5JvfemfbsWPHLd29bbVtszyjaDX3VtXJ3X3PuLXsM2N8X5JTV8w7ZYzty3JZtHJ8z2oH7u4rk1yZJNu2bevt27evNu3vmOXZIMnyc0Ref+val3zHhWuf80jIN4180yxyvkXOlsh3rOzZsyez/L1+o8g3zSLnW+RsiXxTyTeNfPNb5GyJfFPJN4188zuW2eYtiq5PsjPJFeP321aM/0hV7c7yw6z3jzLpXUl+9qG3oyU5J8nL548NwKLzMHAAAHjkWbMoqqq3ZHk10FOq6u4sv73siiTXVtXFSe5M8uIx/R1JzkuyN8kXkrw0Sbr7vqp6dZKbx7xXdfehD8gGAAAAYAOtWRR19w8cZtPZq8ztJJce5jhXJ7n6iNIBAAAAcMzM+9YzAAAAAB5lFEUAAAAAJFEUAQAAADAoigAAAABIoigCAAAAYFjzrWcA8Gh02q4bZpp32daDuWiGuXdc8cKpkQAAYMNZUQQAAABAEkURAAAAAIOiCAAAAIAkiiIAAAAABkURAAAAAEkURQAAAAAMmzY6AADw1U7bdcNM8y7bejAXzTD3jiteODUSAACPAVYUAQAAAJDEiiIAYA6LvOJpkbMBACw6RREAwDGkyAIAFplbzwAAAABIYkURAAArWPEEAI9tVhQBAAAAkERRBAAAAMCgKAIAAAAgiWcUAQDwCOIZSgBwdCmKAABgnSiyAHikUxQBAMBjhCILgLV4RhEAAAAASRRFAAAAAAyKIgAAAACSeEYRAACwIDxDCWDjKYoAAADWsOgl1qLnAx453HoGAAAAQBJFEQAAAACDoggAAACAJJ5RBAAAwFHmGUrwyGFFEQAAAABJFEUAAAAADIoiAAAAAJIoigAAAAAYPMwaAACAxzQP24avsKIIAAAAgCSKIgAAAAAGRREAAAAASTagKKqqc6vqY1W1t6p2HevzAwAAALC6Y/ow66p6XJL/mOS7k9yd5Oaqur67bzuWOQAAAOCRYtEftr3o+Tgyx/qtZ2cm2dvdn0iSqtqd5PwkiiIAAABg3S1ykbWI2Y71rWdbkty14vvdYwwAAACADVbdfexOVvV9Sc7t7n8+vv9QkrO6+0dWzLkkySXj67cm+dg6RnhKkr9cx+OtN/mmkW+aRc63yNkS+aaSbxr55rfI2RL5ppJvGvnmt8jZEvmmkm8a+ea33tn+Xnc/dbUNx/rWs31JTl3x/ZQx9mXdfWWSK4/Gyavqj7p729E49nqQbxr5plnkfIucLZFvKvmmkW9+i5wtkW8q+aaRb36LnC2Rbyr5ppFvfscy27G+9ezmJKdX1dOq6vFJLkhy/THOAAAAAMAqjumKou4+WFU/kuRdSR6X5Oru/sixzAAAAADA6o71rWfp7nckecexPu9wVG5pW0fyTSPfNIucb5GzJfJNJd808s1vkbMl8k0l3zTyzW+RsyXyTSXfNPLN75hlO6YPswYAAABgcR3rZxQBAAAAsKAURQAAAAAk2YBnFPEVVfUPkpyfZMsY2pfk+u7+6MalWl1Vvam7X7LROR4pqurMJN3dN1fVM5Kcm+RPxzO6eBhV9WNJ3trdd210lkeq8feWLUne190HVoyf292/t3HJFl9VnZXko939uao6PsmuJM9NcluSn+3u/Ruc71uS/OMkpyb5UpI/S/KfuvtzG5mL9VdV35HkzCQf7u7f3+g8wOpWvMn5z7v7P1fVDyb5H5N8NMmV3f03GxoQYA6eUbRBquplSX4gye4kd4/hU7L8D5rd3X3FBma7/tChJDuSvDtJuvt7j3moI1BVL+3uX93A81+e5AVZLmJvTHJWkvck+e4k7+ru125UtkeCqtqf5PNJPp7kLUl+q7v/YmNTPXKMou3SLP8L6nOS/Hh3v21s+0B3P3cj8y26qvpIkmePt3RemeQLSa5LcvYY/8cbmO3HknxPkj9Icl6SDyZ5IMn/muSHu3vPRmVjuqp6f3efOT7/71n+3/Fbk5yT5Hc38t8LHqmq6snd/dmNzsGjW1X9Rpb/ne8JWf578uYkv5Plf25Ud+/cwHiPSFX1jd39mY3OAY9lj9qiqKo+kOW/Sb+luz++0XkOVVV/luSZh/5XhvFfJT7S3advTLIv/9ndluRXknSWi6K3ZLnESnf/l43KNouq+lR3f/MGnv/WLP8f9K9L8ukkp6xYnfC+7v7vNyrbI0FVfTDJGfn/2zv3GDuLMoz/noJpgMqtQFvCvaVKCDcpSQmijQKKKFRAiiSWqzESUKtgFBohBLWgQKCxigYKog2Ui4ByCaBIQC2sIKXFcokgFIHaChJB1NA+/jFz2m/P7lmEZXfmrO8vOdlvv8nJeTLfN7f3MgMHADOAQ4EHSe/gDbb/UVBe9eT3b1/br0ragWTkuMr2xZL+YHuvogIrR9Iy27vk616GNUkP296zoLYlwJ62V0vaELjV9jRJ2wE3lX62kjYBvg5MB7YijR9/BW4C5tj+e0F51dNsn5J6gI/ZXilpI2CR7d0K61sbkZif9YXAPsBSYJbtFYX1zQG+a3uVpCnAQmAN8C5gZum5i6SNSe1jG+A22wsaZfNsn1xMXDAoJD1ie3dJ65OyA7bO/bSAxTXO+2oyxEjavP0Wad63F2mt+tLwqwreCSSNB84i9cXfAE4FjiA5M79o+4WC8jrSDU4GSbfZPngof2Mk71G0GbApcLekByTNkrR1aVEN1gD96ZmQy0oyhdRBnwm8kr3Ur9u+p/REq4WkRzp8lgDjCst7w/Zq2/8E/tRKCbH9OuWfLZAm/I3rTSRdlutvgaTS9Wfba2zfYftEUjuZR0rfe6qstLX1NUfSY5JekvQ3ScvyvU1L6wNGtdLNbP8ZmAYcLOlC0uSrKJKmSLpb0k8kbSvpTkmvSOqRVIMRa6mk4/P14rzgRNJkoIb0gVbK+GiS1xrbz5IWw6VZCLwMTLO9ue2xpGjUl3NZcSQ9JGm2pImltfTDKEmbSRpLWhytBLD9GvBGWWkAfKtxfQHwAvAJoAe4tIii3hxie1W+/g4ww/YkUjTvBeVkrWU+qQ++Hjha0vWSRueyqeVkJSSNl/R9Sd+TNFbS2ZKWSFooaUJpfQMh6bbCEkZlR++7SVFFm+T7o6mgb5a0edtnLPBA7m/ajTQlWEVad7Q+vyelzz+Ur4siaWNJ35Z0VU4rbJbNK6WroWGMpHMkPZrnUyslLZJ0XGltwBWk4IPlpOyK10kR0fcCPygnax15/r5Fvp4i6SngfknPSPpgYW3v6/DZmxSUMKSM5D2KXrZ9GnCapP1JaV4PSVpGijL6YVl5fAn4paQnSY0HYDtgEnBKMVWA7TXARZKuzX9XUN+7Mg74CGkB0kTAb4dfTi/+I2nDbCjau3Uze2CrMBSRJvytvWqaE/7DSRP+6YV0QZsxI0fd3QzcnKMoSrOQlIY5zfaLsNZjcmwuO6igNoAVkva0/TBAjiz6OHA5UDQiITOP5F3alNRWZ9k+UNKHc9m+JcUBJwEXS5pNmrz+TtJyUj99UlFlKcqzR9L9wP7AeQCStgRq8LjuYPu85o3cRs6TdEIhTe00nUgvkiIVr7H9fFlZQFpcPkjqAy1pgu0XJI2hAiNvG1Ma0XUXSaohtWZ9SevbfgPYwHYPgO0nGgaZkky0fUS+vlHSmcCvJNWSzn8FcAuwEWlB91PSgm46aUF3WDFlpAVTpyKGYcH0JlwGPAasR3KyXpsXm1NJW0yUZhXwTNu9liHGwE7Drqg3p5MMuqfbXgIg6WnbO5aVtZb5wJMkI+8Jko4AjrH9byow8pLa6s9I66KjSG34amC2pMm2zyiobZztuQCSTm7MEeZKOrGgriaH2P5avm45GXqyg3ABKYCiFD3APfQ/Bxhy5/SITj1r34tD0nqkjmiG7eP7/+bwIWkUaaPK5mbWPbZXl1PVF0mHAPsV7mh6IekyYL7t+/opW2D7mH6+NixIGp0Hj/b7WwATWoNgSZrtQ23pNO3/F9A22fYTpX7/zZD0uO33vNWy4ULSNqSothf7KdvP9m8KyGpqaKbX9EoTVUWpcUppIjuSjOTPlU6raSFpV2AX0gbHj5XW00TSHcBdwJWt+soRiscBB9o+oKA8oE/f13IiHU4Kg6/BidSHbCAfZ/vpwjqeI6WbibR/0kTnSaRy6k1hfaeSHB5zgA+QjII3AB8CdrL9mYLyyI7KXbMzrnXvONIieYzt7Utpy1oG6puLzguyhtV0XjBNtb3BMEvqhXLWgu3nlaKLDwCetf1ASV0Akr5C3YaY1tzlIpJT5ixSyl5pAxbQ7zz5TJIR9VDgzvb15nAjabHtPRr/99jeJ68z/2j7vTVok3Su7dmNsiWlU6qzjmXAbk57Uy6yPbVRVlSjpKXAJ20/2U/ZctvbDuXv1xYl8k7SZ6GZDTC3sy6Soih5srCotI43w/YtJC9TNeSUpE5lxYxE+ff7GIny/VUkr04NbCXpy6QJ18aS1JrwUzgltWYjUeYZSV+l/8Vw8ZPabD83QFlRI1HmX5IOIkVPWNJ02zfm8N5qjOQ5ZXRxaR3t2H4UeLS0jg7MIJ0Sd09uEwZWkCICjyoprD9s3wvcmw0MB5L0V2coytGpRY1EmR+RUmsArgS2AFbmiMqHi6nK2J6rlH7+eWAyaY67M3AjcG5JbZmfk4xWd7Vu2L4iR7bNLaZqHc2x/8dtZesNp5AOLAM+12nBVEBPL5pRiU77sV1XUE4vbF8g6RpS9F/LEFNVpECeu3wqR9jdSUrhq4XRkka1jLy2vynpL6SDJcaUlQbAa5Leb/u+XH8vQVpnSiodjXqTpDG2X20zEk0CHi+oq8k84Falfe5ul3Qx65wMpce2s+m8Ljt1qH98xEYUAXFEdBB0QOlktibznDZNHQ+cb3tmCV3dgKTNSIvhw0gb9sK6xfAc2+3pkEEDSXsA55PSMGeRFnXHkiIqP2u7dOpoMAjyuLsNafPl6sZdSVfbPrq0jm6l9nlVF+s72HbRfXYknUMa/19tuz+JNLYdWUbZWh1HAkts91lcthwOBWR1HdmQcAYpVXh8aT0tmm2D5DSaaHtpDW1X0vnAHbbvarv/UWCuCx5AlHXsTkpN35nkSDohp9xuCXza9iWF9VXdLwNImkZvJ8NykpPhcqd05mKUrL8RayjKHsJTiCOig+AtIel42/NL6+hGou4GR9RfdyPpC6SUpK4cd+P9G5ja51W1v3+1199A1N42atdXG0qn8LYMMcXrrva2OxA11N9AlNbXzf0eVFF/RdvGSDYUxRHRQfA2aN+bIPjfibobHFF/3U23j7vx/g1M7c839A0dtbeN2vXVTA11F21j6Citr5ufLUT9jeQ9inodEZ1Dyq6TtD39b4QXBP83SHqkUxHpRLmgA1F3gyPqb0RT/bgb79+gqP35hr5BUHvbqF1fzXRB3UXbGASV66v62ULU30CMZENR7UdEB0FJxpGO0WzfT0ekI8uDzkTdDY6ov5FLN4y78f69fWp/vqFvcNTeNmrXVzO11120jcFRs77any1E/XVkJBuKZgK9Np/Km1HNlHRpGUlBUA2/IB3H22c3f0m/Hn45XUXU3eCI+hu5dMO4G+/f26f25xv6BkftbaN2fTVTe91F2xgcNeur/dlC1F9HRuweRUEQBEEQBEEQBEEQBMFbY1RpAUEQBEEQBEEQBEEQBEEdhKEoCIIgCIIgCIIgCIIgAMJQFARBEARBEARBEARBEGTCUBQEQRAEQRAEQRAEQRAAYSgKgiAIgiAIgiAIgiAIMv8FEjeCzRh19YQAAAAASUVORK5CYII=\n"},"metadata":{"needs_background":"light"}}]},{"cell_type":"code","source":["for x, y in df_train['emotions'].value_counts().iteritems():\n","  print(emotion_labels[int(x)], y)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"ifOIxAoO1toj","executionInfo":{"status":"ok","timestamp":1662200277578,"user_tz":-180,"elapsed":386,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"45d5d3ee-3821-49b0-b34f-9997faa83f4e"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["нейтральность 8320\n","восхищение 2652\n","одобрение 1670\n","веселье 1437\n","раздражение 1392\n","благодарность 1342\n","любопытство 1147\n","неодобрение 1075\n","злость 996\n","любовь 973\n","замешательство 808\n","разочарование 657\n","оптимизм 632\n","радость 629\n","забота 607\n","грусть 572\n","удивление 479\n","реализация 461\n","восторг 449\n","отвращение 361\n","желание 352\n","страх 341\n","угрызение совести 266\n","смущение 168\n","нервозность 69\n","облегчение 64\n","сожаление 47\n","гордость 34\n"]}]},{"cell_type":"code","source":["df_train"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"e0YLq2JpBQ5A","executionInfo":{"status":"ok","timestamp":1662199961217,"user_tz":-180,"elapsed":365,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"310a3f8d-80af-472b-d8e6-ad3afa7384ea"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                 text_ru emotions\n","0      Моя любимая еда - это все, что мне не приходил...       27\n","1      Теперь, если он покончит с собой, все подумают...       27\n","2                         КАКОГО ХРЕНА БЭЙЛЕСС ДЕРГАЕТСЯ        2\n","3                Чтобы заставить ее почувствовать угрозу       14\n","4                                  Грязные Южные Дрочеры        3\n","...                                                  ...      ...\n","27995  Я буквально расплакалась, читая это. Этот бедн...        0\n","27996  На кого конкретно мы будем подавать в суд? Инд...        1\n","27997     Крэк-шлюхи теперь трахаются средь бела дня, а?        7\n","27998  Извините, если я медлю здесь, но какое отношен...       24\n","27999  Эй, это в Португалии? Я узнаю соус франсезинья...        7\n","\n","[28000 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-dd5043ab-a935-4201-97e4-066bb75adb8b\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text_ru</th>\n","      <th>emotions</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Моя любимая еда - это все, что мне не приходил...</td>\n","      <td>27</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Теперь, если он покончит с собой, все подумают...</td>\n","      <td>27</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>КАКОГО ХРЕНА БЭЙЛЕСС ДЕРГАЕТСЯ</td>\n","      <td>2</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Чтобы заставить ее почувствовать угрозу</td>\n","      <td>14</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Грязные Южные Дрочеры</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>27995</th>\n","      <td>Я буквально расплакалась, читая это. Этот бедн...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>27996</th>\n","      <td>На кого конкретно мы будем подавать в суд? Инд...</td>\n","      <td>1</td>\n","    </tr>\n","    <tr>\n","      <th>27997</th>\n","      <td>Крэк-шлюхи теперь трахаются средь бела дня, а?</td>\n","      <td>7</td>\n","    </tr>\n","    <tr>\n","      <th>27998</th>\n","      <td>Извините, если я медлю здесь, но какое отношен...</td>\n","      <td>24</td>\n","    </tr>\n","    <tr>\n","      <th>27999</th>\n","      <td>Эй, это в Португалии? Я узнаю соус франсезинья...</td>\n","      <td>7</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>28000 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-dd5043ab-a935-4201-97e4-066bb75adb8b')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-dd5043ab-a935-4201-97e4-066bb75adb8b button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-dd5043ab-a935-4201-97e4-066bb75adb8b');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":39}]},{"cell_type":"code","source":["df_test"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":424},"id":"c9Qt2CFHW5jH","executionInfo":{"status":"ok","timestamp":1662199306119,"user_tz":-180,"elapsed":540,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"cf5d16c0-aa54-4c13-c3a8-df634d872b53"},"execution_count":null,"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                text_ru emotions\n","0     Я действительно сожалею о вашей ситуации : ( Х...       25\n","1     Это замечательно, потому что это ужасно. На не с.        0\n","2     Фанат Kings здесь, удачи вам, ребята! Будет ин...       13\n","3     Я этого не знал, спасибо тебе за то, что научи...       15\n","4     Им наскучило бродить по земле в течение тысяч ...       27\n","...                                                 ...      ...\n","5422  Спасибо. После госпитализации мне также постав...       15\n","5423                          Что ж, в этом есть смысл.        4\n","5424                             Проблемы с папой [ИМЯ]       27\n","5425  Так рад, что обнаружил этот субреддит пару мес...        0\n","5426  Когда мои дети были маленькими, мне пришлось с...       27\n","\n","[5427 rows x 2 columns]"],"text/html":["\n","  <div id=\"df-aeda39ef-7e47-4bfa-8ddf-3bce36bbd4db\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>text_ru</th>\n","      <th>emotions</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>Я действительно сожалею о вашей ситуации : ( Х...</td>\n","      <td>25</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>Это замечательно, потому что это ужасно. На не с.</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>Фанат Kings здесь, удачи вам, ребята! Будет ин...</td>\n","      <td>13</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>Я этого не знал, спасибо тебе за то, что научи...</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>Им наскучило бродить по земле в течение тысяч ...</td>\n","      <td>27</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>5422</th>\n","      <td>Спасибо. После госпитализации мне также постав...</td>\n","      <td>15</td>\n","    </tr>\n","    <tr>\n","      <th>5423</th>\n","      <td>Что ж, в этом есть смысл.</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>5424</th>\n","      <td>Проблемы с папой [ИМЯ]</td>\n","      <td>27</td>\n","    </tr>\n","    <tr>\n","      <th>5425</th>\n","      <td>Так рад, что обнаружил этот субреддит пару мес...</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>5426</th>\n","      <td>Когда мои дети были маленькими, мне пришлось с...</td>\n","      <td>27</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5427 rows × 2 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-aeda39ef-7e47-4bfa-8ddf-3bce36bbd4db')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-aeda39ef-7e47-4bfa-8ddf-3bce36bbd4db button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-aeda39ef-7e47-4bfa-8ddf-3bce36bbd4db');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":17}]},{"cell_type":"code","source":["num_labels = df_train['emotions'].nunique()\n","num_examples = df_train.shape[0] # row count"],"metadata":{"id":"-WCXq-0dLr-B"},"execution_count":null,"outputs":[]},{"cell_type":"markdown","source":["#Model setup"],"metadata":{"id":"tSOz-LtjMi8L"}},{"cell_type":"code","source":["from transformers import BertTokenizer, TFBertForSequenceClassification, InputExample, InputFeatures, BertConfig"],"metadata":{"id":"LKXNiSiwMqoy"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#Load tokenizer and model config\n","tokenizer = BertTokenizer.from_pretrained(model_checkpoint, from_pt=True)\n","config = BertConfig.from_pretrained(model_checkpoint, num_labels=num_labels)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":113,"referenced_widgets":["0b71a1fb1f664154977f16449a436dd2","3d75442a07dc41788c04d58c6afdae56","fbfde7ab75264efcaa31c30b91a5e488","4fc3835b2ebe4c74ab973c1573a2e6ac","8a2bffc8d9d14982848eefcaf8b6240a","b2a64613d3c149aab640d29d725d6739","68ea6332e6c746d38b97c43a9a872850","06c4bc2864824e5a967c51bdf5f20996","af594ebc093241ed8c526a042b4049a7","d980648957cd4b15a3a2539fc427f7c1","cc27a38ba3384283b5f72422b259d312","2eeb5517d66f447199bf15b082f14fb3","df21ad688d974ecd8db829d67ded30bd","28ac007521a64687b46276732a70b411","d66338ca495245a5be7eb326e42ca398","7cf3f54869654c0a97bb4ef41eb3d4c2","14f9e6c434bd4917be1632074a0e41f5","61d4d25fc1c24b38873712b2ff24eb02","05ca74bb72704f9e8d65da7bebe27699","952365bc376d4a7080027d67b93cbb93","37c696a0d47747a287e26f23bb2dac8b","48202f51088f40fda6a50f242830b6d4","7ffc811ad1b04f809832044ba4a53071","dbb97451793a4d2eba3043e381a4affa","4d362863dc03450396928886cc5db41b","d9d6a6533b1f4efc9a50ded41c814e92","9053fe4cb8834c278f5ce4725a213f80","67daacc99876483789ccd5810dca7a8f","14533a2f106147beb34fd5cff8fad306","10007eacfb7c4e03be277c5a8a1eb22a","b3ff25f80d7946f384d7f908704fa563","91d1e6dfbef44e6392ac6b6939a105f8","fa35dac13937444ba8582ba793250a1e"]},"id":"AKMszG-246Eb","executionInfo":{"status":"ok","timestamp":1662200335645,"user_tz":-180,"elapsed":7404,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"7b43b89f-8676-49bb-c3ae-ee2ff1cc1849"},"execution_count":null,"outputs":[{"output_type":"display_data","data":{"text/plain":["Downloading special_tokens_map.json:   0%|          | 0.00/112 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"0b71a1fb1f664154977f16449a436dd2"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading tokenizer_config.json:   0%|          | 0.00/24.0 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"2eeb5517d66f447199bf15b082f14fb3"}},"metadata":{}},{"output_type":"display_data","data":{"text/plain":["Downloading config.json:   0%|          | 0.00/642 [00:00<?, ?B/s]"],"application/vnd.jupyter.widget-view+json":{"version_major":2,"version_minor":0,"model_id":"7ffc811ad1b04f809832044ba4a53071"}},"metadata":{}}]},{"cell_type":"code","source":["#Load base model\n","model = TFBertForSequenceClassification.from_pretrained(model_checkpoint, from_pt=True, config=config)"],"metadata":{"id":"OJ7ru_uJmi0N"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["#Load fine-tuned model\n","from tensorflow import keras\n","model = keras.models.load_model('/content/drive/MyDrive/SentiChallenge/checkpoints/rubert-sentiment-28CL-28K-3EP')"],"metadata":{"id":"hMhfpRxOmYV5"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["model.summary()"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"YObdal_H4Q12","executionInfo":{"status":"ok","timestamp":1662200670896,"user_tz":-180,"elapsed":8,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"c502691a-39e0-4c14-dff6-90c40ba6d206"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Model: \"tf_bert_for_sequence_classification_1\"\n","_________________________________________________________________\n"," Layer (type)                Output Shape              Param #   \n","=================================================================\n"," bert (TFBertMainLayer)      multiple                  177853440 \n","                                                                 \n"," dropout_75 (Dropout)        multiple                  0         \n","                                                                 \n"," classifier (Dense)          multiple                  21532     \n","                                                                 \n","=================================================================\n","Total params: 177,874,972\n","Trainable params: 177,874,972\n","Non-trainable params: 0\n","_________________________________________________________________\n"]}]},{"cell_type":"markdown","source":["#Converting data for input"],"metadata":{"id":"NcodvoQJUXFM"}},{"cell_type":"code","source":["def convert_data_to_examples(train, test, DATA_COLUMN, LABEL_COLUMN): \n","  train_InputExamples = train.apply(lambda x: InputExample(guid=None, \n","                                                          text_a = x[DATA_COLUMN], \n","                                                          text_b = None,\n","                                                          label = x[LABEL_COLUMN]), axis = 1)\n","\n","  validation_InputExamples = test.apply(lambda x: InputExample(guid=None, \n","                                                          text_a = x[DATA_COLUMN], \n","                                                          text_b = None,\n","                                                          label = x[LABEL_COLUMN]), axis = 1)\n","  \n","  return train_InputExamples, validation_InputExamples\n","  \n","def convert_examples_to_tf_dataset(examples, tokenizer, max_length=128):\n","    features = [] \n","\n","    for e in examples:\n","        input_dict = tokenizer.encode_plus(\n","            e.text_a,\n","            add_special_tokens=True,\n","            max_length=max_length, \n","            return_token_type_ids=True,\n","            return_attention_mask=True,\n","            pad_to_max_length=True, \n","        )\n","\n","        input_ids, token_type_ids, attention_mask = (input_dict[\"input_ids\"],\n","            input_dict[\"token_type_ids\"], input_dict['attention_mask'])\n","\n","        features.append(\n","            InputFeatures(\n","                input_ids=input_ids, attention_mask=attention_mask,\n","                token_type_ids=token_type_ids, label=e.label\n","            )\n","        )\n","\n","    def gen():\n","        for f in features:\n","            yield (\n","                {\n","                    \"input_ids\": f.input_ids,\n","                    \"attention_mask\": f.attention_mask,\n","                    \"token_type_ids\": f.token_type_ids,\n","                },\n","                f.label,\n","            )\n","\n","    return tf.data.Dataset.from_generator(\n","        gen,\n","        ({\"input_ids\": tf.int32, \"attention_mask\": tf.int32, \"token_type_ids\": tf.int32}, tf.int64),\n","        (\n","            {\n","                \"input_ids\": tf.TensorShape([None]),\n","                \"attention_mask\": tf.TensorShape([None]),\n","                \"token_type_ids\": tf.TensorShape([None]),\n","            },\n","            tf.TensorShape([]),\n","        ),\n","    )"],"metadata":{"id":"-vui4eH1UcGh"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["DATA_COLUMN = 'text_ru'\n","LABEL_COLUMN = 'emotions'\n","\n","train_InputExamples, validation_InputExamples = convert_data_to_examples(df_train, df_test, \n","                                                                         DATA_COLUMN, LABEL_COLUMN)\n","\n","# Make the CPU do all data pre-processing steps, not the GPU\n","with tf.device('/cpu:0'):\n","  train_data = convert_examples_to_tf_dataset(list(train_InputExamples), tokenizer)\n","  train_data = train_data.shuffle(buffer_size = num_examples, reshuffle_each_iteration=True) \\\n","                         .batch(batch_size) \\\n","                         .repeat(-1)\n","\n","  validation_data = convert_examples_to_tf_dataset(list(validation_InputExamples), tokenizer)\n","  validation_data = validation_data.batch(batch_size)"],"metadata":{"id":"mFCbjHLCxV5m","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1662200406849,"user_tz":-180,"elapsed":16977,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"c297220d-4317-4d05-b889-5b9170d152d4"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["Truncation was not explicitly activated but `max_length` is provided a specific value, please use `truncation=True` to explicitly truncate examples to max length. Defaulting to 'longest_first' truncation strategy. If you encode pairs of sequences (GLUE-style) with the tokenizer you can select this strategy more precisely by providing a specific strategy to `truncation`.\n","/usr/local/lib/python3.7/dist-packages/transformers/tokenization_utils_base.py:2329: FutureWarning: The `pad_to_max_length` argument is deprecated and will be removed in a future version, use `padding=True` or `padding='longest'` to pad to the longest sequence in the batch, or use `padding='max_length'` to pad to a max length. In this case, you can give a specific length with `max_length` (e.g. `max_length=45`) or leave max_length to None to pad to the maximal input size of the model (e.g. 512 for Bert).\n","  FutureWarning,\n"]}]},{"cell_type":"markdown","source":["#Training"],"metadata":{"id":"LtiEWIMtOy4t"}},{"cell_type":"code","source":["model.compile(optimizer = tf.keras.optimizers.Adam(learning_rate=3e-5, epsilon=1e-08), \n","              loss = tf.keras.losses.SparseCategoricalCrossentropy(from_logits=True), \n","              metrics = [tf.keras.metrics.SparseCategoricalAccuracy('accuracy')])\n","\n","train_steps = num_examples // batch_size\n"],"metadata":{"id":"NbWuM6j4Rr3k"},"execution_count":null,"outputs":[]},{"cell_type":"code","source":["history = model.fit(train_data, \n","                    epochs=epochs,\n","                    steps_per_epoch = train_steps)"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"SJEI8tc-OqhI","executionInfo":{"status":"ok","timestamp":1662158776782,"user_tz":-180,"elapsed":2198266,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"d6f36224-109a-4b54-9e88-cee856df4225"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/3\n","875/875 [==============================] - 734s 813ms/step - loss: 1.9313 - accuracy: 0.4714\n","Epoch 2/3\n","875/875 [==============================] - 718s 813ms/step - loss: 1.3761 - accuracy: 0.5944\n","Epoch 3/3\n","875/875 [==============================] - 717s 813ms/step - loss: 0.9669 - accuracy: 0.7128\n"]}]},{"cell_type":"markdown","source":["#Testing"],"metadata":{"id":"owy93lLHOtah"}},{"cell_type":"code","source":["pred_sentences = ['Ужасный сервис. Висит все утро, почините хоть что-то!',\n","                  'Добрый день, спасибо за быструю помощь!',\n","                  'Что вы собираетесь сделать по этому поводу?',\n","                  'Мне ничего не понятно из вашего объяснения',\n","                  'Крайне жаль что так произошло',\n","                  'Честно говоря, я расстроен работой вашей службы поддержки',\n","                  '',\n","                  'УРА, ВСЕ ВОССТАНОВИЛОСЬ',\n","                  'Ну и сколько мне еще ждать вашего ответа, м?',\n","                  'Жаль потраченного времени.',\n","                  'Да ну вас всех к черту',\n","                  'О господи',\n","                  'ВЫ ЧТО ИЗДЕВАЕТЕСЬ?! ВЕРНИТЕ МНЕ ДЕНЬГИ НЕМЕДЛЕННО!']\n","\n","tf_batch = tokenizer(pred_sentences, max_length=128, padding=True, truncation=True, return_tensors='tf')\n","tf_outputs = model(tf_batch)\n","tf_predictions = tf.nn.softmax(tf_outputs[0], axis=-1)\n","labels = emotion_labels\n","label = tf.argmax(tf_predictions, axis=1)\n","label = label.numpy()\n","for i in range(len(pred_sentences)):\n","  print(pred_sentences[i], \": \\n\", labels[label[i]])"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"XNXBxekdRcrx","executionInfo":{"status":"ok","timestamp":1662163162596,"user_tz":-180,"elapsed":642,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"e8132d20-e667-4bb6-fa74-514105fd1279"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["Ужасный сервис. Висит все утро, почините хоть что-то! : \n"," отвращение\n","Добрый день, спасибо за быструю помощь! : \n"," благодарность\n","Что вы собираетесь сделать по этому поводу? : \n"," любопытство\n","Мне ничего не понятно из вашего объяснения : \n"," замешательство\n","Крайне жаль что так произошло : \n"," угрызение совести\n","Честно говоря, я расстроен работой вашей службы поддержки : \n"," разочарование\n"," : \n"," нейтральность\n","УРА, ВСЕ ВОССТАНОВИЛОСЬ : \n"," восхищение\n","Ну и сколько мне еще ждать вашего ответа, м? : \n"," любопытство\n","Жаль потраченного времени. : \n"," разочарование\n","Да ну вас всех к черту : \n"," злость\n","О господи : \n"," удивление\n","ВЫ ЧТО ИЗДЕВАЕТЕСЬ?! ВЕРНИТЕ МНЕ ДЕНЬГИ НЕМЕДЛЕННО! : \n"," злость\n"]}]},{"cell_type":"code","source":["model.save('/content/drive/MyDrive/SentiChallenge/checkpoints/rubert-sentiment-28CL-28K-3EP')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"wFm4Busdgmif","executionInfo":{"status":"ok","timestamp":1662162060818,"user_tz":-180,"elapsed":39454,"user":{"displayName":"Станислав Чумаков","userId":"08332204488166174685"}},"outputId":"ed7c2388-29ca-4ec5-fd44-924ea5c02310"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stderr","text":["WARNING:absl:Found untraced functions such as embeddings_layer_call_fn, embeddings_layer_call_and_return_conditional_losses, encoder_layer_call_fn, encoder_layer_call_and_return_conditional_losses, pooler_layer_call_fn while saving (showing 5 of 420). These functions will not be directly callable after loading.\n"]}]}]}